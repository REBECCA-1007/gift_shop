<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Collections — Rebecca’s Choice</title>
  <meta name="description" content="Browse curated mini-gift collections by family: Wedding, Birthday, Christmas, Summer.">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Satisfy&display=swap" rel="stylesheet">

  <!-- Base styles (shared) -->
  <link rel="stylesheet" href="assets/styles.css">

  <style>
    :root{
      --brand:#0e2b4a;
      --muted:#5a6a7a;
      --border:rgba(0,0,0,.08);
      --shadow:0 10px 26px rgba(0,0,0,.06);
      --chip:#eef2f5;
      --pill-bg: rgba(255,255,255,.92);
      --header-h:60px;
    }
    html,body{ margin:0; overflow-x:hidden; font-family:Inter, system-ui, -apple-system,"Segoe UI", Roboto, "Helvetica Neue", Arial,"Noto Sans"; }
    .container{ max-width:1200px; margin:0 auto; padding:0 16px; }

    /* Header (giống trang chủ bản 6: fixed + chừa khoảng) */
    header{
      position:fixed; top:0; left:0; right:0; z-index:1000;
      background:rgba(255,255,255,.95);
      backdrop-filter:saturate(180%) blur(6px);
      border-bottom:1px solid var(--border);
    }
    body{ padding-top: var(--header-h); }
    header .nav{ display:flex; align-items:center; justify-content:space-between; gap:16px; min-height:60px; }
    .brand{ display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--brand); }
    .brand .title{ font-family:"Satisfy",cursive; font-size:28px; font-weight:700; line-height:1; }
    .menu{ display:flex; gap:16px; flex-wrap:wrap; }
    .menu a{ color:var(--brand); text-decoration:none; padding:8px 10px; border-radius:999px; font-weight:600; }
    .menu a:hover{ background:var(--chip); }
    .tools .chip{ background:var(--chip); padding:8px 12px; border-radius:999px; text-decoration:none; color:var(--brand); }

    /* Page head */
    .page-head{ padding:28px 0 16px; }
    .page-head h1{ margin:0 0 6px; color:var(--brand); }
    .crumbs{ color:var(--muted); font-size:14px; }

    /* Layout: sidebar + grid */
    .layout{ display:grid; grid-template-columns: 240px 1fr; gap:24px; padding:8px 0 48px; }
    @media (max-width:920px){
      .layout{ grid-template-columns:1fr; }
    }

    /* Sidebar (Family) */
    .sidebar{
      position:sticky; top:calc(var(--header-h) + 12px);
      align-self:start;
      border:1px solid var(--border);
      border-radius:14px;
      background:#fff;
      box-shadow:var(--shadow);
      padding:14px;
    }
    .sidebar h3{ margin:4px 0 10px; font-size:16px; color:var(--brand); }
    .sidebar ul{ list-style:none; margin:0; padding:0; display:grid; gap:6px; }
    .sidebar a{
      display:block; text-decoration:none;
      color:var(--muted); padding:10px 12px;
      border-radius:10px;
    }
    .sidebar a:hover{ background:var(--chip); color:var(--brand); }
    .sidebar a.active{
      color:#fff; background:var(--brand);
    }

    /* On mobile: chuyển sidebar thành thanh ngang cuộn */
    @media (max-width:920px){
      .sidebar{ position:static; padding:10px; }
      .sidebar ul{ grid-auto-flow:column; grid-auto-columns:max-content; overflow:auto; gap:8px; }
      .sidebar a{ white-space:nowrap; border:1px solid var(--border); background:#fff; }
      .sidebar a.active{ background:var(--brand); border-color:var(--brand); }
    }

    /* Toolbar above grid */
    .toolbar{
      display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px;
      flex-wrap:wrap;
    }
    .pill{ padding:6px 10px; border:1px solid var(--border); border-radius:999px; background:#fff; color:var(--muted); }

    /* Grid of cards (giữ style đồng bộ) */
    .grid{ display:grid; gap:18px; grid-template-columns: repeat(12,1fr); }
    .card{ grid-column: span 3; border:1px solid var(--border); border-radius:16px; background:#fff; box-shadow:var(--shadow); overflow:hidden; }
    .card img{ width:100%; height:190px; object-fit:cover; display:block; }
    .card .info{ padding:12px 14px; }
    .badge{ display:inline-block; padding:6px 10px; border-radius:999px; border:1px solid var(--border); color:var(--brand); text-decoration:none; font-size:12px; }
    .price{ font-weight:700; color:#1a2140; }
    .btn{ display:inline-block; padding:10px 14px; border-radius:999px; text-decoration:none; }
    .btn-primary{ background:#c5a020; color:#1a2140; font-weight:700; }
    @media (max-width:1200px){ .card{ grid-column: span 4; } }
    @media (max-width:820px){ .card{ grid-column: span 6; } }
    @media (max-width:520px){ .card{ grid-column: span 12; } }

    /* Footer full‑bleed navy (đồng bộ bản 6) */
    footer.footer-bleed{
      position:relative; background:#0e2b4a; color:#fff; margin:0; padding:0; overflow:hidden;
      width:100vw; left:50%; right:50%; margin-left:-50vw; margin-right:-50vw;
    }
    footer.footer-bleed .footer__inner{
      max-width:1200px; margin:0 auto; padding:clamp(20px,3.2vw,36px) 24px;
      display:flex; align-items:center; justify-content:space-between; gap:14px; flex-wrap:wrap;
    }
    footer.footer-bleed a{
      color:#fff; text-decoration:none; padding:8px 12px; border-radius:999px;
      border:1px solid rgba(255,255,255,.5); background:transparent;
    }
    footer.footer-bleed a:hover{ border-color:#fff; }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header>
    <div class="container nav">
      <a class="brand" href="index.html"><div class="title">Rebecca’s Choice</div></a>
      <nav class="menu">
        <a href="index.html#signature">Collections</a>
        <a href="index.html#bestsellers">Bestsellers</a>
        <a href="index.html#occasions">Occasions</a>
        <a href="index.html#arrivals">New Arrivals</a>
        <a href="about.html">Why Rebecca’s Choice</a>
      </nav>
      <div class="tools">
        <a class="chip" href="cart.html">Cart <span id="cart-count">0</span></a>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="page-head">
      <div class="crumbs"><a href="index.html" style="color:var(--muted); text-decoration:none;">Home</a> · Collections</div>
      <h1>All Collections</h1>
    </div>

    <div class="layout">
      <!-- SIDEBAR -->
      <aside class="sidebar">
        <h3>Families</h3>
        <ul id="family-list">
          <li><a href="#" class="active" data-cat="All">All</a></li>
          <li><a href="#" data-cat="Wedding">Wedding</a></li>
          <li><a href="#" data-cat="Birthday">Birthday</a></li>
          <li><a href="#" data-cat="Christmas">Christmas</a></li>
          <li><a href="#" data-cat="Summer">Summer</a></li>
        </ul>
      </aside>

      <!-- CONTENT -->
      <section>
        <div class="toolbar">
          <div class="pill" id="count-pill">0 items</div>
          <div class="pill" id="active-cat">Showing: All</div>
        </div>

        <div class="grid" id="grid"></div>
      </section>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="footer-bleed">
    <div class="footer__inner">
      <div>© <span id="y"></span> Rebecca’s Choice — <em>“Gifts are the flowers of memory.”</em></div>
      <nav>
        <a href="about.html">About</a>
        <a href="#">Shipping</a>
        <a href="#">Returns</a>
        <a href="#">Contact</a>
      </nav>
    </div>
    <script>document.getElementById('y').textContent = new Date().getFullYear();</script>
  </footer>

  <!-- DATA & SCRIPTS -->
  <script src="assets/products.js"></script>
  <script>
    const $=(s,ctx=document)=>ctx.querySelector(s);
    const $$=(s,ctx=document)=>Array.from(ctx.querySelectorAll(s));

    function getCart(){ try{return JSON.parse(localStorage.getItem('cart')||'[]')}catch{return[]} }
    function updateCartCount(){ const c=getCart().reduce((s,it)=>s+it.qty,0); const el=$('#cart-count'); if(el) el.textContent=c; }
    function setHeaderSpace(){ const h=document.querySelector('header'); if(h) document.documentElement.style.setProperty('--header-h', h.offsetHeight+'px'); }

    function renderGrid(cat="All"){
      if(!window.PRODUCTS) return;
      const list = (cat && cat!=="All") ? window.PRODUCTS.filter(p=>p.category===cat) : window.PRODUCTS.slice();
      const grid = $('#grid');
      grid.innerHTML = list.map(p=>`
        <article class="card">
          <a href="product.html?id=${encodeURIComponent(p.id)}"><img src="${p.image}" alt="${p.title}"></a>
          <div class="info">
            <div class="badge">${p.category}</div>
            <h3 style="margin:8px 0">${p.title}</h3>
            <p class="meta" style="margin:0 0 10px; color:var(--muted)">${p.desc||""}</p>
            <div style="display:flex; align-items:center; justify-content:space-between">
              <span class="price">$${Number(p.price).toFixed(2)}</span>
              <a class="btn btn-primary" href="product.html?id=${encodeURIComponent(p.id)}">View</a>
            </div>
          </div>
        </article>
      `).join('');
      $('#count-pill').textContent = `${list.length} item${list.length!==1?'s':''}`;
      $('#active-cat').textContent = `Showing: ${cat||'All'}`;
    }

    function applyCatFromURL(){
      const u=new URL(location.href);
      const cat=u.searchParams.get('cat');
      if(!cat) return "All";
      // Chọn link active trong sidebar
      $$('#family-list a').forEach(a=>{
        a.classList.toggle('active', a.dataset.cat===cat);
      });
      return cat;
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      updateCartCount();
      setHeaderSpace();
      window.addEventListener('resize', setHeaderSpace);

      // Bind sidebar
      $$('#family-list a').forEach(a=>{
        a.addEventListener('click', e=>{
          e.preventDefault();
          $$('#family-list a').forEach(x=>x.classList.remove('active'));
          a.classList.add('active');
          const cat=a.dataset.cat||'All';
          const url=new URL(location.href);
          url.searchParams.set('cat', cat);
          history.replaceState({}, '', url);
          renderGrid(cat);
        });
      });

      // Đọc cat từ URL nếu có (?cat=Wedding ...)
      const initialCat = applyCatFromURL();
      renderGrid(initialCat);
    });
  </script>
</body>
</html>
